<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai&display=swap" rel="stylesheet">
</head>
<body style="background-image: url(oilbg.png);background-repeat: no-repeat;background-size: cover;font-family: 'Noto Sans Thai', sans-serif;">
    <p style="font-size: 2cm;position: absolute;top: -62px;width: 100%;text-align: center;">ราคาน้ำมันวันนี้</p>
    <p id="date" style="font-size: 0.7cm;font-style: bold;position: absolute;left: 500px;top: 117px;color: white;width: 200px;text-align: center;"></p>
    <p id="today1" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 160px;"></p>
    <p id="today2" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 235px;"></p>
    <p id="today3" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 310px;"></p>
    <p id="today4" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 390px;"></p>
    <p id="today5" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 540px;"></p>
    <p id="today6" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 620px;"></p>
    <p id="today7" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 695px;"></p>
    <p id="today8" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 770px;"></p>
    <p id="tomor1" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 128px;"></p>
    <p id="tomor2" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 203px;"></p>
    <p id="tomor3" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 278px;"></p>
    <p id="tomor4" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 358px;"></p>
    <p id="tomor5" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 513px;"></p>
    <p id="tomor6" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 588px;"></p>
    <p id="tomor7" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 663px;"></p>
    <p id="tomor8" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 738px;"></p>
    <p id="diff1" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 165px;text-align: center;width: 100px;">-</p>
    <p id="diff2" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 240px;text-align: center;width: 100px;">-</p>
    <p id="diff3" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 315px;text-align: center;width: 100px;">-</p>
    <p id="diff4" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 395px;text-align: center;width: 100px;">-</p>
    <p id="diff5" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 545px;text-align: center;width: 100px;">-</p>
    <p id="diff6" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 625px;text-align: center;width: 100px;">-</p>
    <p id="diff7" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 700px;text-align: center;width: 100px;">-</p>
    <p id="diff8" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 775px;text-align: center;width: 100px;">-</p>
    <script>
        //fetch from topapi.pwisetthon.com
        var requestOptions = {
            method: 'GET',
            redirect: 'follow'
        };

        fetch("https://anywhere.pwisetthon.com/https://topapi.pwisetthon.com", requestOptions)
        .then(response => response.json())
        .then(result => {
            //date = result[0][0];
            let date = result[0][0];
            //get month from date
            let month = date.substring(3,5);
            //convert month to month thai name
            let month_thai = "";
            switch(month){
                case "01":
                    month_thai = "มกราคม";
                    break;
                case "02":
                    month_thai = "กุมภาพันธ์";
                    break;
                case "03":
                    month_thai = "มีนาคม";
                    break;
                case "04":
                    month_thai = "เมษายน";
                    break;
                case "05":
                    month_thai = "พฤษภาคม";
                    break;
                case "06":
                    month_thai = "มิถุนายน";
                    break;
                case "07":
                    month_thai = "กรกฎาคม";
                    break;
                case "08":
                    month_thai = "สิงหาคม";
                    break;
                case "09":
                    month_thai = "กันยายน";
                    break;
                case "10":
                    month_thai = "ตุลาคม";
                    break;
                case "11":
                    month_thai = "พฤศจิกายน";
                    break;
                case "12":
                    month_thai = "ธันวาคม";
                    break;
            }

            document.getElementById("date").innerHTML = date.substring(0,2) + " " + month_thai + " " + date.substring(6,10);

            document.getElementById("today1").innerHTML = result[1][1];
            document.getElementById("today2").innerHTML = result[1][2];
            document.getElementById("today3").innerHTML = result[1][3];
            document.getElementById("today4").innerHTML = result[1][4];
            document.getElementById("today5").innerHTML = result[1][5];
            document.getElementById("today6").innerHTML = result[1][6];
            document.getElementById("today7").innerHTML = result[1][7];
            document.getElementById("today8").innerHTML = result[1][8];
            document.getElementById("tomor1").innerHTML = result[0][1];
            document.getElementById("tomor2").innerHTML = result[0][2];
            document.getElementById("tomor3").innerHTML = result[0][3];
            document.getElementById("tomor4").innerHTML = result[0][4];
            document.getElementById("tomor5").innerHTML = result[0][5];
            document.getElementById("tomor6").innerHTML = result[0][6];
            document.getElementById("tomor7").innerHTML = result[0][7];
            document.getElementById("tomor8").innerHTML = result[0][8];
            //if result[2][x] is 0, then diff is -, else diff is result[2][x]
            if(result[2][1] == 0){
                document.getElementById("diff1").innerHTML = "-";
            }else{
                //if result[2][x] > 0, then add + sign to diff , else no sign
                if(result[2][1] > 0){
                    document.getElementById("diff1").innerHTML = "+" + result[2][1];
                }else{
                    document.getElementById("diff1").innerHTML = result[2][1];
                }
            }
            if(result[2][2] == 0){
                document.getElementById("diff2").innerHTML = "-";
            }else{
                if(result[2][2] > 0){
                    document.getElementById("diff2").innerHTML = "+" + result[2][2];
                }else{
                    document.getElementById("diff2").innerHTML = result[2][2];
                }
            }
            if(result[2][3] == 0){
                document.getElementById("diff3").innerHTML = "-";
            }else{
                if(result[2][3] > 0){
                    document.getElementById("diff3").innerHTML = "+" + result[2][3];
                }else{
                    document.getElementById("diff3").innerHTML = result[2][3];
                }
            }
            if(result[2][4] == 0){
                document.getElementById("diff4").innerHTML = "-";
            }else{
                if(result[2][4] > 0){
                    document.getElementById("diff4").innerHTML = "+" + result[2][4];
                }else{
                    document.getElementById("diff4").innerHTML = result[2][4];
                }
            }
            if(result[2][5] == 0){
                document.getElementById("diff5").innerHTML = "-";
            }else{
                if(result[2][5] > 0){
                    document.getElementById("diff5").innerHTML = "+" + result[2][5];
                    document.getElementById("diff5").style.color = "red";
                    document.getElementById("diff5").style.fontWeight = "bold";
                    document.getElementById("tomor5").style.color = "red";
                    document.getElementById("tomor5").style.fontWeight = "bold";
                    //left position of tomor5 -10px
                    document.getElementById("tomor5").style.left = document.getElementById("tomor5").style.left.replace("px", "") - 15 + "px";
                    //top position of tomor5 -5px
                    document.getElementById("tomor5").style.top = document.getElementById("tomor5").style.top.replace("px", "") - 5 + "px";
                }else{
                    document.getElementById("diff5").innerHTML = result[2][5];
                    document.getElementById("diff5").style.color = "green";
                    document.getElementById("diff5").style.fontWeight = "bold";
                    document.getElementById("tomor5").style.color = "green";
                    document.getElementById("tomor5").style.fontWeight = "bold";
                    //left position of tomor5 -10px
                    document.getElementById("tomor5").style.left = document.getElementById("tomor5").style.left.replace("px", "") - 15 + "px";
                    //top position of tomor5 -5px
                    document.getElementById("tomor5").style.top = document.getElementById("tomor5").style.top.replace("px", "") - 5 + "px";
                }
            }
            if(result[2][6] == 0){
                document.getElementById("diff6").innerHTML = "-";
            }else{
                if(result[2][6] > 0){
                    document.getElementById("diff6").innerHTML = "+" + result[2][6];
                    document.getElementById("diff6").style.color = "red";
                    document.getElementById("diff6").style.fontWeight = "bold";
                    document.getElementById("tomor6").style.color = "red";
                    document.getElementById("tomor6").style.fontWeight = "bold";
                    //left position of tomor5 -10px
                    document.getElementById("tomor6").style.left = document.getElementById("tomor6").style.left.replace("px", "") - 15 + "px";
                    //top position of tomor5 -5px
                    //document.getElementById("tomor6").style.top = document.getElementById("tomor6").style.top.replace("px", "") - 5 + "px";
                }else{
                    document.getElementById("diff6").innerHTML = result[2][6];
                    document.getElementById("diff6").style.color = "green";
                    document.getElementById("diff6").style.fontWeight = "bold";
                    document.getElementById("tomor6").style.color = "green";
                    document.getElementById("tomor6").style.fontWeight = "bold";
                    //left position of tomor5 -10px
                    document.getElementById("tomor6").style.left = document.getElementById("tomor6").style.left.replace("px", "") - 15 + "px";
                    //top position of tomor5 -5px
                    //document.getElementById("tomor6").style.top = document.getElementById("tomor6").style.top.replace("px", "") - 5 + "px";
                    
                }
            }
            if(result[2][7] == 0){
                document.getElementById("diff7").innerHTML = "-";
            }else{
                if(result[2][7] > 0){
                    document.getElementById("diff7").innerHTML = "+" + result[2][7];
                    document.getElementById("diff7").style.color = "red";
                    document.getElementById("diff7").style.fontWeight = "bold";
                    document.getElementById("tomor7").style.color = "red";
                    document.getElementById("tomor7").style.fontWeight = "bold";
                    //left position of tomor5 -10px
                    document.getElementById("tomor7").style.left = document.getElementById("tomor7").style.left.replace("px", "") - 15 + "px";
                    //top position of tomor5 -5px
                    //document.getElementById("tomor7").style.top = document.getElementById("tomor7").style.top.replace("px", "") - 5 + "px";
                }else{
                    document.getElementById("diff7").innerHTML = result[2][7];
                    document.getElementById("diff7").style.color = "green";
                    document.getElementById("diff7").style.fontWeight = "bold";
                    document.getElementById("tomor7").style.color = "green";
                    document.getElementById("tomor7").style.fontWeight = "bold";
                    //left position of tomor5 -10px
                    document.getElementById("tomor7").style.left = document.getElementById("tomor7").style.left.replace("px", "") - 15 + "px";
                    //top position of tomor5 -5px
                    //document.getElementById("tomor7").style.top = document.getElementById("tomor7").style.top.replace("px", "") - 5 + "px";
                }
            }
            if(result[2][8] == 0){
                document.getElementById("diff8").innerHTML = "-";
            }else{
                if(result[2][8] > 0){
                    document.getElementById("diff8").innerHTML = "+" + result[2][8];
                    document.getElementById("diff8").style.color = "red";
                    document.getElementById("diff8").style.fontWeight = "bold";
                    document.getElementById("tomor8").style.color = "red";
                    document.getElementById("tomor8").style.fontWeight = "bold";
                    //left position of tomor5 -10px
                    document.getElementById("tomor8").style.left = document.getElementById("tomor8").style.left.replace("px", "") + 15 + "px";
                    //top position of tomor5 -5px
                    document.getElementById("tomor8").style.top = document.getElementById("tomor8").style.top.replace("px", "") + 5 + "px";
                }else{
                    document.getElementById("diff8").innerHTML = result[2][8];
                    document.getElementById("diff8").style.color = "green";
                    document.getElementById("diff8").style.fontWeight = "bold";
                    document.getElementById("tomor8").style.color = "green";
                    document.getElementById("tomor8").style.fontWeight = "bold";
                    //left position of tomor5 -10px
                    document.getElementById("tomor8").style.left = document.getElementById("tomor8").style.left.replace("px", "") - 15 + "px";
                    //top position of tomor5 -5px
                    //document.getElementById("tomor8").style.top = document.getElementById("tomor8").style.top.replace("px", "") - 5 + "px";
                }
            }
        })
        .catch(error => console.log('error', error));
    </script>
</body>
</html>
