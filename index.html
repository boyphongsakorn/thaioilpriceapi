<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai&display=swap" rel="stylesheet">
</head>
<body style="background-image: url(oilbg.png);background-repeat: no-repeat;background-size: cover;font-family: 'Noto Sans Thai', sans-serif;">
    <p id="texttitle" style="font-size: 2cm;position: absolute;top: -62px;width: 100%;text-align: center;left: -2px;">ราคาน้ำมันวันนี้</p>
    <!--p id="olddate" style="font-size: 0.7cm;font-style: bold;position: absolute;left: 270px;top: 117px;color: white;width: 200px;text-align: center;"></p>
    <p id="date" style="font-size: 0.7cm;font-style: bold;position: absolute;left: 500px;top: 117px;color: white;width: 200px;text-align: center;"></p> 
    <p id="today1" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 160px;"></p>
    <p id="today2" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 235px;"></p>
    <p id="today3" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 310px;"></p>
    <p id="today4" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 390px;"></p>
    <p id="today8" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 540px;"></p>
    <p id="today7" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 620px;"></p>
    <p id="today6" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 695px;"></p>
    <p id="today5" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 770px;"></p>
    <p id="today9" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 465px;"></p>
    <p id="today10" style="font-size: 1cm;font-style: italic;position: absolute;left: 322px;top: 845px;"></p>
    <p id="tomor1" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 123px;"></p>
    <p id="tomor2" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 203px;"></p>
    <p id="tomor3" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 278px;"></p>
    <p id="tomor4" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 358px;"></p>
    <p id="tomor8" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 508px;"></p>
    <p id="tomor7" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 583px;"></p>
    <p id="tomor6" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 663px;"></p>
    <p id="tomor5" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 738px;"></p>
    <p id="tomor9" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 466px;top: 433px;width: 268px;text-align: center;"></p>
    <p id="tomor10" style="font-size: 1.5cm;font-style: italic;position: absolute;left: 530px;top: 812px;"></p>
    <p id="diff1" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 165px;text-align: center;width: 100px;">-</p>
    <p id="diff2" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 240px;text-align: center;width: 100px;">-</p>
    <p id="diff3" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 315px;text-align: center;width: 100px;">-</p>
    <p id="diff4" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 395px;text-align: center;width: 100px;">-</p>
    <p id="diff8" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 545px;text-align: center;width: 100px;">-</p>
    <p id="diff7" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 625px;text-align: center;width: 100px;">-</p>
    <p id="diff6" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 700px;text-align: center;width: 100px;">-</p>
    <p id="diff5" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 775px;text-align: center;width: 100px;">-</p>
    <p id="diff9" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 470px;text-align: center;width: 100px;">-</p>
    <p id="diff10" style="font-size: 1cm;font-style: italic;position: absolute;left: 775px;top: 850px;text-align: center;width: 100px;">-</p-->
    <table style="position: absolute;top: 130px;left: 80px;color: black;width: 835px;text-align: center;background-color: transparent;max-height: 820px;height: 820px;">
        <tr>
            <th style="width: 190px;height: 55px;font-size: 0.75cm;color: white;">ชื่อ/ชนิด</th>
            <th id="olddate" style="background-color: transparent;color: white;width: 180px;font-size: 0.75cm;">วันนี้</th>
            <th id="date" style="background-color: transparent;color: white;font-size: 0.75cm;">พรุ่งนี้</th>
            <th style="background-color: transparent;color: white;width: 170px;font-size: 0.75cm;">ส่วนต่าง</th>
        </tr>
        <tr id="oil1">
            <td style="background: url('https://oil-price.bangchak.co.th/api/image?fileName=HPDSb7.jpg');border-radius: 20px;background-repeat: repeat;background-position: center center;"></td>
            <td id="today1" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor1" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff1" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
        <tr id="oil2">
            <td style="background: url('https://oil-price.bangchak.co.th/api/image?fileName=HiDieselSb.jpg');border-radius: 20px;background-repeat: repeat;background-position: center center;"></td>
            <td id="today2" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor2" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff2" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
        <tr id="oil3">
            <td style="background: url('https://oil-price.bangchak.co.th/api/image?fileName=HiDieselS.jpg');border-radius: 20px;background-repeat: repeat;background-position: center center;"></td>
            <td id="today3" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor3" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff3" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
        <tr id="oil4">
            <td style="background: url('https://oil-price.bangchak.co.th/api/image?fileName=HiDieselB20S.jpg');border-radius: 20px;background-repeat: repeat;background-position: center center;"></td>
            <td id="today4" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor4" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff4" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
        <tr id="oil9">
            <td style="background: url('https://orapiweb.pttor.com/uploads/images/20220228_235820_5403.jpg');background-size: 100% 100%;border-radius: 20px;"></td>
            <td id="today9" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor9" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff9" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
        <tr id="oil6">
            <td style="background: url('https://img.gs/fhcphvsghs/160x100,fit/https://oil-price.bangchak.co.th/api/image?fileName=E20evoWeb1-120.jpg');border-radius: 20px;background-repeat: repeat;background-position: center center;"></td>
            <td id="today6" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor6" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff6" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
        <tr id="oil7">
            <td style="background: url('https://img.gs/fhcphvsghs/160x100,fit/https://oil-price.bangchak.co.th/api/image?fileName=GSH91evoWeb1-120.jpg');border-radius: 20px;background-repeat: repeat;background-position: center center;"></td>
            <td id="today7" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor7" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff7" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
        <tr id="oil8">
            <td style="background: url('https://img.gs/fhcphvsghs/160x100,fit/https://oil-price.bangchak.co.th/api/image?fileName=GSH95evoWeb1-120.jpg');border-radius: 20px;background-repeat: repeat;background-position: center center;"></td>
            <td id="today8" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor8" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff8" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
        <tr id="oil5">
            <td style="background: url('https://img.gs/fhcphvsghs/160x100,fit/https://oil-price.bangchak.co.th/api/image?fileName=E85evoWeb1-120.jpg');border-radius: 20px;background-repeat: repeat;background-position: center center;"></td>
            <td id="today5" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor5" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff5" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
        <tr id="oil10">
            <td style="background: url('https://img.gs/fhcphvsghs/200x100,fit/https://oil-price.bangchak.co.th/api/image?fileName=MobileGSH97.gif');border-radius: 20px;background-repeat: repeat;background-position: center center;"></td>
            <td id="today10" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor10" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff10" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
        <tr id="oil11">
            <td style="background: url('https://orapiweb.pttor.com/uploads/images/20220228_212905_1792.jpg');border-radius: 20px;background-size: 100% 100%;"></td>
            <td id="today11" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="tomor11" style="font-size: 1cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;"></td>
            <td id="diff11" style="font-size: 0.75cm;border-radius: 20px;color: black;background-color: white;border-style: solid;border-color: black;">-</td>
        </tr>
    </table>
    <script>
        function monthtotext(month) {
            //convert month to number
            var month = parseInt(month);
            switch (month) {
                case 1:
                    return "มกราคม";
                    break;
                case 2:
                    return "กุมภาพันธ์";
                    break;
                case 3:
                    return "มีนาคม";
                    break;
                case 4:
                    return "เมษายน";
                    break;
                case 5:
                    return "พฤษภาคม";
                    break;
                case 6:
                    return "มิถุนายน";
                    break;
                case 7:
                    return "กรกฎาคม";
                    break;
                case 8:
                    return "สิงหาคม";
                    break;
                case 9:
                    return "กันยายน";
                    break;
                case 10:
                    return "ตุลาคม";
                    break;
                case 11:
                    return "พฤศจิกายน";
                    break;
                case 12:
                    return "ธันวาคม";
                    break;
            }
        }

        //fetch from https://thaioilpriceapi-vercel.vercel.app if don't work redirect to https://topapi.pwisetthon.com
        var requestOptions = {
            method: 'GET',
            redirect: 'follow'
        };

        fetch("https://thaioilpriceapi-vercel.vercel.app", requestOptions)
        //fetch("http://localhost:8080", requestOptions)
        .then(response => response.json())
        .then(result => {

            document.getElementById("olddate").innerText = parseInt(result[1][0].substring(0,2)) + " " + monthtotext(result[1][0].substring(3,5));
            document.getElementById("date").innerText = parseInt(result[0][0].substring(0,2)) + " " + monthtotext(result[0][0].substring(3,5));

            let today = new Date();

            if(result[1][0] == today.getDate().toString().padStart(2, '0') + '/' + (today.getMonth() + 1).toString().padStart(2, '0') + '/' + (today.getFullYear()+543)) {
                document.getElementById("olddate").innerText = "วันนี้";
                document.getElementById("date").innerText = "พรุ่งนี้";
            }

            if(result[0][0] == today.getDate().toString().padStart(2, '0') + '/' + (today.getMonth() + 1).toString().padStart(2, '0') + '/' + (today.getFullYear()+543)) {
                document.getElementById("date").innerText = "วันนี้";
                if(result[1][0] == (today.getDate()-1).toString().padStart(2, '0') + '/' + (today.getMonth() + 1).toString().padStart(2, '0') + '/' + (today.getFullYear()+543)) {
                    document.getElementById("olddate").innerText = "เมื่อวาน";
                }
                
            }

            if(result[0][0] ==  (today.getDate()+1).toString().padStart(2, '0') + '/' + (today.getMonth() + 1).toString().padStart(2, '0') + '/' + (today.getFullYear()+543)) {
                document.getElementById("date").innerText = "พรุ่งนี้";
                document.getElementById("texttitle").innerText = "ราคาน้ำมันพรุ่งนี้";
            }

            document.getElementById("today1").innerText = result[1][1];
            document.getElementById("today2").innerText = result[1][2];
            document.getElementById("today3").innerText = result[1][3];
            document.getElementById("today4").innerText = result[1][4];
            document.getElementById("today5").innerText = result[1][5];
            document.getElementById("today6").innerText = result[1][6];
            document.getElementById("today7").innerText = result[1][7];
            document.getElementById("today8").innerText = result[1][8];
            document.getElementById("today9").innerText = result[1][9];
            document.getElementById("today10").innerText = result[1][10];
            document.getElementById("today11").innerText = result[1][11];
            //document.getElementById("today12").innerText = result[1][12];
            document.getElementById("tomor1").innerText = result[0][1];
            document.getElementById("tomor2").innerText = result[0][2];
            document.getElementById("tomor3").innerText = result[0][3];
            document.getElementById("tomor4").innerText = result[0][4];
            document.getElementById("tomor5").innerText = result[0][5];
            document.getElementById("tomor6").innerText = result[0][6];
            document.getElementById("tomor7").innerText = result[0][7];
            document.getElementById("tomor8").innerText = result[0][8];
            document.getElementById("tomor9").innerText = result[0][9];
            document.getElementById("tomor10").innerText = result[0][10];
            document.getElementById("tomor11").innerText = result[0][11];
           // document.getElementById("tomor12").innerText = result[0][12];
            var listresult = ["1","2","3","4","5","6","7","8","9","10","11"];
            //loop result
            for(var i = 0; i < listresult.length; i++){
                if(result[2][i+1] == 0){
                    document.getElementById("diff"+listresult[i]).innerHTML = "-";
                    //set tr height to 15px
                    document.getElementById("oil"+listresult[i]).style.height = "15px";
                    //set font size cut a hlaf
                    document.getElementById("today"+listresult[i]).style.fontSize = parseFloat(document.getElementById("today"+listresult[i]).style.fontSize) / 2 + "cm";
                    document.getElementById("tomor"+listresult[i]).style.fontSize = parseFloat(document.getElementById("tomor"+listresult[i]).style.fontSize) / 2 + "cm";
                    document.getElementById("diff"+listresult[i]).style.fontSize = parseFloat(document.getElementById("diff"+listresult[i]).style.fontSize) / 2 + "cm";
                }else{
                    let color = "red";
                    if(result[2][i+1] < 0){
                        color = "green";
                    }
                        //document.getElementById("diff"+listresult[i]).innerHTML = "+" + result[2][i+1];
                        document.getElementById("today"+listresult[i]).innerHTML = "<h1 style='font-size: 1cm;margin-top: 0px;margin-bottom: 0px;line-height: 45px;'>" + result[1][i+1] + "</h1>";
                        document.getElementById("diff"+listresult[i]).innerHTML = "<h1 style='font-size: 1cm;margin-top: 0px;margin-bottom: 0px;line-height: 45px;'>" + "+" + result[2][i+1] + "</h1>";
                        document.getElementById("diff"+listresult[i]).style.color = color;
                        document.getElementById("diff"+listresult[i]).style.fontWeight = "bold";
                        document.getElementById("diff"+listresult[i]).style.borderColor = color;
                        document.getElementById("tomor"+listresult[i]).innerHTML = "<h1 style='font-size: 1.5cm;margin-top: 0px;margin-bottom: 0px;line-height: 45px;'>" + result[0][i+1] + "</h1>";
                        document.getElementById("tomor"+listresult[i]).style.fontSize = "none";
                        document.getElementById("tomor"+listresult[i]).style.color = color;
                        document.getElementById("tomor"+listresult[i]).style.fontWeight = "bold";
                        document.getElementById("tomor"+listresult[i]).style.borderColor = color;
                        //left and top position of tomor5 -3px
                        //document.getElementById("tomor"+listresult[i]).style.left = (parseInt(document.getElementById("tomor"+listresult[i]).style.left.replace("px", "")) + -3) + "px";
                        //document.getElementById("tomor"+listresult[i]).style.top = (parseInt(document.getElementById("tomor"+listresult[i]).style.top.replace("px", "")) + -3) + "px";
                        //document.getElementById("diff"+listresult[i]).style.top = (parseInt(document.getElementById("diff"+listresult[i]).style.top.replace("px", "")) + -3) + "px";
                    //}else{
                        //document.getElementById("diff"+listresult[i]).innerHTML = result[2][i+1];
                        //document.getElementById("diff"+listresult[i]).style.color = "green";
                        //document.getElementById("diff"+listresult[i]).style.fontWeight = "bold";
                        //document.getElementById("diff"+listresult[i]).style.borderColor = "green";
                        //document.getElementById("tomor"+listresult[i]).style.color = "green";
                        //document.getElementById("tomor"+listresult[i]).style.fontWeight = "bold";
                        //document.getElementById("tomor"+listresult[i]).style.borderColor = "green";
                        //left and top position of tomor5 -3px
                        //document.getElementById("tomor"+listresult[i]).style.left = (parseInt(document.getElementById("tomor"+listresult[i]).style.left.replace("px", "")) + -3) + "px";
                        //document.getElementById("tomor"+listresult[i]).style.top = (parseInt(document.getElementById("tomor"+listresult[i]).style.top.replace("px", "")) + -3) + "px";
                        //document.getElementById("diff"+listresult[i]).style.top = (parseInt(document.getElementById("diff"+listresult[i]).style.top.replace("px", "")) + -3) + "px";
                    //}
                }
            }
        })
        .catch(error => console.log('error', error));
    </script>
</body>
</html>
